{{- define "main" -}}

<article class="article article-project">
  {{ partial "page_header" . }}

  <div class="article-container">
    <div class="article-meta mb-3">
      <button type="button" class="btn btn-outline-secondary">Identifier: {{.Params.identifier}}</button>
      <button type="button" class="btn btn-outline-secondary">{{.Params.studyType}}</button>
      <a type="button" class="btn btn-outline-primary" href="{{.Params.studyUrl}}"><i class="fas fa-link mr-1"></i>URL</a>
      <a type="button" class="btn btn-outline-primary" href="{{.Params.discussionUrl}}"><i class="fas fa-comments mr-1"></i>Forum Discussion</a>
      <a type="button" class="btn btn-outline-primary" href="{{.Params.result.url}}"><i class="fas fa-link mr-1"></i>Result</a>
      <a type="button" class="btn btn-outline-primary" href="{{.Params.license}}"><i class="fas fa-link mr-1"></i>License</a>
    </div>
    <div class="article-style">

      <!-- <p>{{ .Summary }}</p> -->
      <p>{{ .Description }}</p>
      
      <ul class="nav nav-tabs" id="myTab" role="tablist">
        <li class="nav-item">
          <a class="nav-link active" id="details-tab" data-toggle="tab" href="#details" role="tab" aria-controls="details" aria-selected="true">Details</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" id="software-tab" data-toggle="tab" href="#software" role="tab" aria-controls="software" aria-selected="false">Software</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" id="databases-tab" data-toggle="tab" href="#databases" role="tab" aria-controls="databases" aria-selected="false">Databases</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" id="citations-tab" data-toggle="tab" href="#citations" role="tab" aria-controls="citations" aria-selected="false">Citations</a>
        </li>
      </ul>
      <div class="tab-content" id="myTabContent">
        <div class="tab-pane fade show active" id="details" role="tabpanel" aria-labelledby="details-tab">
          <b>Drugs:</b> <ul>
            {{range .Params.drugs}}
            <li>{{.name}}</li>
            {{end}}
          </ul>
          <b>Health Conditions:</b> <ul>
            {{range .Params.healthConditions}}
            <li>{{.name}}</li>
            {{end}}
          </ul>
          <b>Event:</b> {{.Params.event.name}} <i>({{.Params.event.startDate}} to {{.Params.event.endDate}})</i> at {{.Params.event.location}}, Organizer: {{.Params.event.organizer}}
        </div>
        <div class="tab-pane fade" id="software" role="tabpanel" aria-labelledby="software-tab">
          <b>Applications:</b> <ul>
            {{range .Params.softwareApplications}}
              <li><a href="{{.installUrl}}">{{.name}}</a> Version: {{.version}}</li>
            {{end}}
          </ul>
          <b>Source Codes:</b> <ul>
            {{range .Params.softwareSourceCodes}}
              <li><a href="{{.codeRepository}}">{{.name}}</a> Version: {{.version}}, Programming Language: {{.programmingLanguage}}, Maintainer: {{.maintainer}}</li>
            {{end}}
          </ul>

        </div>
        <div class="tab-pane fade" id="databases" role="tabpanel" aria-labelledby="databases-tab">
          <b>Databases:</b> <ul>{{range $i, $e := .Params.databases}}
          {{- $db_page := site.GetPage (printf "/database/%s" $e) -}}
          <li><a href="{{$db_page.URL}}">{{$db_page.Params.title}}</a></li>
          {{end}}
          </ul>
        </div>
        <div class="tab-pane fade" id="citations" role="tabpanel" aria-labelledby="citations-tab">
          <ul>
          {{range .Params.citations}}
            <li><a href="{{.url}}">{{.author}}. <i>{{.articleTitle}}</i>, {{.datePublished}}</a></li>
          {{end}}
          </ul>
        </div>
      </div>
      {{ .Content }}
    </div>

    {{ partial "page_footer" . }}

    <div class="project-related-pages content-widget-hr">
      {{ $page := . }}
      {{ $project := .File.ContentBaseName }}

      {{ $items := where (where site.RegularPages "Type" "post") ".Params.projects" "intersect" (slice $project) }}
      {{ $count := len $items }}
      {{ if ge $count 1 }}
      <h2>{{ (i18n "posts") }}</h2>
      {{ range $items }}
      {{ if eq site.Params.projects.post_view 1 }}
      {{ partial "li_list" . }}
      {{ else if eq site.Params.projects.post_view 3 }}
      {{ partial "li_card" . }}
      {{ else }}
      {{ partial "li_compact" . }}
      {{ end }}
      {{ end }}
      {{ end }}

      {{ $items := where (where site.RegularPages "Type" "publication") ".Params.projects" "intersect" (slice $project) }}
      {{ $pubs_len := len $items }}
      {{ if ge $pubs_len 1 }}
      <h2>{{ (i18n "publications") }}</h2>
      {{ range $items }}
      {{ if eq site.Params.projects.publication_view 1 }}
      {{ partial "li_list" . }}
      {{ else if eq site.Params.projects.publication_view 3 }}
      {{ partial "li_card" . }}
      {{ else if eq site.Params.projects.publication_view 4 }}
      {{ partial "li_citation" . }}
      {{ else }}
      {{ partial "li_compact" . }}
      {{ end }}
      {{ end }}
      {{ end }}

      {{ $items := where (where site.RegularPages "Type" "talk") ".Params.projects" "intersect" (slice $project) }}
      {{ $talks_len := len $items }}
      {{ if ge $talks_len 1 }}
      <h2>{{ (i18n "talks") }}</h2>
      {{ range $items }}
      {{ if eq site.Params.projects.talk_view 1 }}
      {{ partial "li_list" . }}
      {{ else if eq site.Params.projects.talk_view 3 }}
      {{ partial "li_card" . }}
      {{ else }}
      {{ partial "li_compact" . }}
      {{ end }}
      {{ end }}
      {{ end }}
    </div>
  </div>
</article>


{{- end -}}
